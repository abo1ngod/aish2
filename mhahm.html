<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†Ø¸Ù… Ø§Ù„Ø±Ø­Ù„Ø§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #faf8f5; --card: #fff; --text: #2d3436; --accent: #e17055; --border: #dfe6e9; }
        .dark { --bg: #1a1d21; --card: #252a30; --text: #f5f6fa; --border: #3d4450; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); color: var(--text); margin: 0; min-height: 100vh; transition: 0.3s; padding: 20px; }
        * { box-sizing: border-box; outline: none; }
        
        .container { max-width: 900px; margin: 0 auto; }
        header { text-align: center; padding: 20px; font-size: 1.5rem; color: var(--accent); }
        header::before { content: 'âœˆï¸'; display: block; font-size: 3rem; animation: float 3s ease-in-out infinite; }
        @keyframes float { 50% { transform: translateY(-10px); } }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: var(--card); padding: 20px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .head { border-bottom: 2px solid var(--border); padding-bottom: 10px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-weight: bold; font-size: 1.2rem; }
        
        input, button { padding: 12px; border: 2px solid var(--border); border-radius: 8px; font: inherit; background: var(--bg); color: var(--text); }
        input:focus { border-color: var(--accent); }
        .row { display: flex; gap: 10px; margin-bottom: 15px; }
        .btn-add { background: var(--accent); color: white; border: none; cursor: pointer; font-weight: bold; }
        .btn-add:hover { opacity: 0.9; }
        
        .list { max-height: 300px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; }
        .item { display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--bg); border-radius: 8px; animation: pop 0.3s; }
        @keyframes pop { from { transform: scale(0.9); opacity: 0; } }
        
        .check { width: 20px; height: 20px; border: 2px solid var(--border); border-radius: 5px; cursor: pointer; display: flex; justify-content: center; align-items: center; }
        .done .check { background: #00b894; border-color: #00b894; }
        .done .check::after { content: 'âœ“'; color: #fff; font-size: 12px; }
        .done span { text-decoration: line-through; opacity: 0.6; }
        .del { margin-right: auto; background: none; border: none; color: #e17055; font-size: 1.2rem; cursor: pointer; padding: 0 5px; }
        
        .total { margin-top: 15px; padding: 15px; background: var(--accent); color: white; border-radius: 8px; display: flex; justify-content: space-between; font-weight: bold; }
        .empty { text-align: center; color: var(--border); padding: 20px; font-size: 1.2rem; }
        
        @media (prefers-color-scheme: dark) { :root { --bg: #1a1d21; --card: #252a30; --text: #f5f6fa; --border: #3d4450; } }
    </style>
</head>
<body>
    <div class="container">
        <header><h1>Ù…Ù†Ø¸Ù… Ø§Ù„Ø±Ø­Ù„Ø§Øª</h1></header>
        <div class="grid">
            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù‡Ø§Ù… -->
            <div class="card">
                <div class="head"><span>ğŸ“</span> Ø§Ù„Ù…Ù‡Ø§Ù…</div>
                <div class="row">
                    <input id="tIn" style="flex:1" placeholder="Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©..." onkeypress="if(event.key==='Enter') add('task')">
                    <button class="btn-add" onclick="add('task')">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div id="tList" class="list"></div>
            </div>
            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª -->
            <div class="card">
                <div class="head"><span>ğŸ’°</span> Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                <div class="row">
                    <input id="eName" style="flex:2" placeholder="Ø§Ù„Ø§Ø³Ù…...">
                    <input id="eAm" type="number" style="flex:1" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" onkeypress="if(event.key==='Enter') add('expense')">
                </div>
                <button class="btn-add" style="width:100%; margin-bottom:15px" onclick="add('expense')">Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ</button>
                <div id="eList" class="list"></div>
                <div id="total" class="total" style="display:none"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</span><span id="tVal">0</span></div>
            </div>
        </div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) document.body.classList.add('dark');
        
        let data = JSON.parse(localStorage.getItem('tripData')) || { tasks: [], expenses: [] };
        
        const save = () => {
            localStorage.setItem('tripData', JSON.stringify(data));
            render();
        };

        const escape = (str) => new Option(str).innerHTML;

        function add(type) {
            if (type === 'task') {
                const val = document.getElementById('tIn').value.trim();
                if (val) { data.tasks.push({ id: Date.now(), txt: val, done: false }); document.getElementById('tIn').value = ''; }
            } else {
                const name = document.getElementById('eName').value.trim();
                const am = parseFloat(document.getElementById('eAm').value);
                if (name && am > 0) { data.expenses.push({ id: Date.now(), name, am }); document.getElementById('eName').value = ''; document.getElementById('eAm').value = ''; }
            }
            save();
        }

        const toggle = (id) => { const t = data.tasks.find(x => x.id === id); if(t) t.done = !t.done; save(); };
        const del = (type, id) => { data[type] = data[type].filter(x => x.id !== id); save(); };

        function render() {
            // Ø±Ø³Ù… Ø§Ù„Ù…Ù‡Ø§Ù…
            const tList = document.getElementById('tList');
            tList.innerHTML = data.tasks.length ? data.tasks.map(t => `
                <div class="item ${t.done ? 'done' : ''}">
                    <div class="check" onclick="toggle(${t.id})"></div>
                    <span>${escape(t.txt)}</span>
                    <button class="del" onclick="del('tasks', ${t.id})">Ã—</button>
                </div>`).join('') : '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…</div>';

            // Ø±Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª
            const eList = document.getElementById('eList');
            eList.innerHTML = data.expenses.length ? data.expenses.map(e => `
                <div class="item">
                    <span style="flex:1">${escape(e.name)}</span>
                    <span style="font-weight:bold; color:var(--accent)">${e.am.toLocaleString()} Ø±ÙŠØ§Ù„</span>
                    <button class="del" onclick="del('expenses', ${e.id})">Ã—</button>
                </div>`).join('') : '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ±ÙˆÙØ§Øª</div>';

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
            const total = data.expenses.reduce((a, b) => a + b.am, 0);
            document.getElementById('total').style.display = data.expenses.length ? 'flex' : 'none';
            document.getElementById('tVal').textContent = total.toLocaleString() + ' Ø±ÙŠØ§Ù„';
        }

        render(); // Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
    </script>
</body>
</html>

