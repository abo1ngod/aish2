<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة الدراسات الإسلامية</title>
    <!-- استيراد الخطوط -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #0f766e;
            --secondary-color: #14b8a6;
            --accent-color: #f59e0b;
            --bg-color: #f0fdfa;
            --text-color: #1f2937;
            --card-bg: #ffffff;
            --danger-color: #ef4444;
            --success-color: #10b981;
            --border-color: #e5e7eb;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.8;
        }

        .container {
            max-width: 950px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding-bottom: 80px;
        }

        /* الهيدر */
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: var(--primary-color);
            color: white;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
        }

        header h1 { margin-bottom: 10px; position: relative; z-index: 1; }

        .admin-trigger {
            position: absolute; top: 15px; left: 15px; cursor: pointer; opacity: 0.6;
            color: white; z-index: 100; padding: 10px; background: rgba(255, 255, 255, 0.1);
            border-radius: 50%; transition: 0.3s;
        }
        .admin-trigger:hover { opacity: 1; background: rgba(255, 255, 255, 0.2); transform: rotate(90deg); }

        /* الأقسام */
        .view-section { display: none; animation: fadeIn 0.4s ease-in-out; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card {
            background: var(--card-bg); padding: 25px; border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px; border: 1px solid var(--border-color);
        }

        /* زر العودة العائم */
        .floating-back-btn {
            position: fixed; bottom: 30px; left: 30px;
            background-color: var(--primary-color); color: white;
            width: 60px; height: 60px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); cursor: pointer; z-index: 1000;
            transition: all 0.3s; border: 3px solid white; font-size: 1.5rem;
        }
        .floating-back-btn:hover { transform: scale(1.1); background-color: var(--secondary-color); }
        .floating-back-btn span {
            font-size: 0.7rem; position: absolute; bottom: -25px;
            background: rgba(0,0,0,0.7); color: white; padding: 2px 8px;
            border-radius: 4px; white-space: nowrap; opacity: 0; transition: opacity 0.3s;
        }
        .floating-back-btn:hover span { opacity: 1; }

        /* المدخلات والأزرار */
        input[type="text"], input[type="password"] {
            width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px;
            font-family: inherit; margin-bottom: 15px;
        }

        .btn {
            display: inline-block; background-color: var(--primary-color); color: white;
            padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer;
            font-weight: bold; width: 100%; text-align: center;
        }
        .btn:hover { background-color: #0d5f58; }
        .btn-outline { background: transparent; border: 2px solid var(--primary-color); color: var(--primary-color); }
        .btn-outline:hover { background: var(--primary-color); color: white; }

        /* تنسيق محتوى الدرس */
        .lesson-content-styled {
            font-family: 'Amiri', serif; font-size: 1.3rem; line-height: 2.2;
            color: #333; background-color: #fff; padding: 30px;
            border-radius: 10px; border-right: 6px solid var(--secondary-color);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.02);
        }
        .lesson-content-styled h2 { color: var(--primary-color); font-family: 'Tajawal', sans-serif; margin-bottom: 20px; }
        .lesson-content-styled p { margin-bottom: 15px; text-align: justify; }

        /* البطاقات والأسئلة */
        .lesson-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .lesson-card {
            background: white; border-radius: 10px; padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); cursor: pointer;
            border-right: 4px solid var(--secondary-color); transition: transform 0.2s;
        }
        .lesson-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .lesson-status { font-size: 0.8rem; color: #6b7280; margin-top: 10px; display: flex; justify-content: space-between; }
        .badge-completed { background-color: #d1fae5; color: #065f46; padding: 2px 8px; border-radius: 4px; }
        .badge-pending { background-color: #fee2e2; color: #991b1b; padding: 2px 8px; border-radius: 4px; }

        .question-block {
            margin-bottom: 20px; padding: 20px; background: #f8fafc;
            border-radius: 8px; border: 1px solid #e2e8f0;
        }
        .question-block.correct { border-right: 5px solid var(--success-color); background: #f0fdf4; }
        .question-block.incorrect { border-right: 5px solid var(--danger-color); background: #fef2f2; }
        .question-text { font-weight: bold; margin-bottom: 15px; font-size: 1.1rem; }

        .options-group label {
            display: flex; align-items: center; margin-bottom: 8px; padding: 12px;
            border-radius: 6px; cursor: pointer; background: white; border: 1px solid #eee;
        }
        .options-group label:hover { background: #f1f5f9; }
        
        .review-mode { pointer-events: none; }
        .opt-correct { background-color: #d1fae5 !important; border-color: #10b981 !important; font-weight: bold; }
        .opt-wrong-selected { background-color: #fee2e2 !important; border-color: #ef4444 !important; text-decoration: line-through; }

        .result-banner {
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
            color: white; padding: 25px; border-radius: 12px; text-align: center;
            margin-bottom: 25px; animation: slideDown 0.5s;
        }
        .motivational-text { font-family: 'Amiri', serif; font-size: 1.4rem; margin-top: 15px; color: #fff3cd; }
        @keyframes slideDown { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        /* تنسيق لوحة التحكم */
        .admin-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 10px; background: #f1f5f9; border: none; cursor: pointer; border-radius: 5px; }
        .tab-btn.active { background: var(--primary-color); color: white; }
        .admin-tab-content { display: none; }
        .admin-tab-content.active { display: block; }
    </style>
</head>
<body>

    <!-- زر العودة العائم -->
    <div id="floating-home-btn" class="floating-back-btn" onclick="showDashboard()" style="display:none;" title="العودة للفهرس">
        <i class="fas fa-home"></i>
        <span>الفهرس</span>
    </div>

    <div class="container">
        <header>
            <div title="لوحة التحكم (للمعلم)" class="admin-trigger" onclick="showAdminLogin()">
                <i class="fas fa-cog fa-lg"></i>
            </div>
            <h1><i class="fas fa-graduation-cap"></i> المنصة التعليمية - الدراسات الإسلامية</h1>
            <div id="user-display" style="display:none; margin-top: 5px; opacity: 0.9; font-size: 0.9rem;"></div>
        </header>

        <!-- 1. الدخول -->
        <div id="auth-view" class="view-section active">
            <div class="card" style="max-width: 450px; margin: 0 auto; text-align: center;">
                <h2 style="color: var(--primary-color); margin-bottom: 20px;">بوابة الطلاب</h2>
                <div id="login-box">
                    <form id="login-form">
                        <input type="text" id="login-username" placeholder="اسم المستخدم" required>
                        <input type="password" id="login-password" placeholder="كلمة المرور" required>
                        <button type="submit" class="btn">دخول</button>
                    </form>
                    <p style="margin-top: 15px;">ليس لديك حساب؟ <a href="#" onclick="toggleAuth('register')" style="color: var(--secondary-color);">سجل جديد</a></p>
                </div>
                <div id="register-box" style="display: none;">
                    <form id="register-form">
                        <input type="text" id="reg-username" placeholder="اسم المستخدم" required>
                        <input type="password" id="reg-password" placeholder="كلمة المرور" required>
                        <input type="text" id="reg-fullname" placeholder="الاسم الثلاثي" required>
                        <input type="text" id="reg-section" placeholder="الشعبة" required>
                        <button type="submit" class="btn" style="background-color: var(--secondary-color);">إنشاء حساب</button>
                    </form>
                    <p style="margin-top: 15px;">لديك حساب؟ <a href="#" onclick="toggleAuth('login')">تسجيل الدخول</a></p>
                </div>
            </div>
        </div>

        <!-- 2. الفهرس -->
        <div id="dashboard-view" class="view-section">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>فهرس الدروس</h2>
                    <button onclick="logout()" class="btn btn-outline" style="width: auto;">خروج</button>
                </div>
                <div class="lesson-grid" id="lessons-list"></div>
            </div>
        </div>

        <!-- 3. عرض الدرس -->
        <div id="lesson-view" class="view-section">
            <div class="card">
                <div id="lesson-content-area" class="lesson-content-styled"></div>
                <div style="margin-top: 30px; text-align: center;">
                    <button onclick="startOrReviewQuiz()" id="quiz-action-btn" class="btn">انتقل إلى الاختبار</button>
                </div>
            </div>
        </div>

        <!-- 4. الاختبار -->
        <div id="quiz-view" class="view-section">
            <div class="card">
                <div id="quiz-header" style="margin-bottom: 20px;">
                    <h2 id="quiz-title" style="border-bottom: 2px solid #eee; padding-bottom: 10px;"></h2>
                    <div id="result-display-area"></div>
                </div>
                <form id="quiz-form">
                    <div id="quiz-questions-area"></div>
                    <button type="submit" id="submit-quiz-btn" class="btn" style="margin-top: 20px;">تسليم الإجابات</button>
                </form>
            </div>
        </div>

        <!-- 5. دخول المعلم -->
        <div id="admin-login-view" class="view-section">
            <div class="card" style="max-width: 400px; margin: 0 auto; text-align: center;">
                <h3>الدخول للوحة التحكم</h3>
                <input type="password" id="admin-pin" placeholder="رمز الدخول (1234)">
                <button onclick="verifyAdmin()" class="btn">دخول</button>
                <button onclick="logout()" class="btn btn-outline" style="margin-top:10px;">عودة</button>
            </div>
        </div>

        <!-- 6. لوحة التحكم -->
        <div id="admin-dashboard-view" class="view-section">
            <div class="card" style="border-top: 5px solid var(--accent-color);">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <h2>لوحة التحكم</h2>
                    <button onclick="logoutAdmin()" class="btn btn-outline" style="width:auto;">خروج</button>
                </div>
                
                <div class="admin-tabs">
                    <button id="btn-tab-students" class="tab-btn active" onclick="switchAdminTab('students')">الطلاب والدرجات</button>
                    <button id="btn-tab-content" class="tab-btn" onclick="switchAdminTab('content')">إدارة النصوص</button>
                    <button id="btn-tab-data" class="tab-btn" onclick="switchAdminTab('data')">البيانات</button>
                </div>

                <div id="tab-students" class="admin-tab-content active">
                    <button onclick="exportGradesCSV()" class="btn" style="width:auto; margin-bottom:10px;">تصدير الدرجات CSV</button>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; font-size:0.9rem;">
                            <thead><tr style="background:#f1f5f9;"><th style="padding:10px; border:1px solid #ddd;">الاسم</th><th style="padding:10px; border:1px solid #ddd;">الشعبة</th><th style="padding:10px; border:1px solid #ddd;">الإنجاز</th><th style="padding:10px; border:1px solid #ddd;">الدرجات</th></tr></thead>
                            <tbody id="students-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <div id="tab-content" class="admin-tab-content">
                    <p>تحرير ملف الدروس (JSON):</p>
                    <textarea id="lessons-json-editor" style="width:100%; height:300px; font-family:monospace; direction:ltr;"></textarea>
                    <button onclick="saveContentChanges()" class="btn" style="margin-top:10px;">حفظ التعديلات</button>
                    <button onclick="resetLessonsToDefault()" class="btn btn-outline" style="margin-top:10px; color:red; border-color:red;">استعادة الافتراضي</button>
                </div>

                <div id="tab-data" class="admin-tab-content">
                    <p>نسخ احتياطي:</p>
                    <textarea id="export-area" style="width:100%; height:100px;" readonly></textarea>
                    <button onclick="copyExportData()" class="btn btn-outline">نسخ</button>
                    <hr style="margin:20px 0;">
                    <p>استيراد:</p>
                    <textarea id="import-area" style="width:100%; height:100px;" placeholder="ألصق كود JSON..."></textarea>
                    <button onclick="importData()" class="btn">استيراد</button>
                </div>
            </div>
        </div>

        <footer><p>جميع الحقوق محفوظة &copy; 2024</p></footer>
    </div>

    <script>
        // --- قاعدة بيانات الدروس الكاملة (25 درس) ---
        const initialLessons = [
            {
                id: 1, type: 'text', title: "الدرس (1): التعريف بعلم التفسير ونشأته",
                summary: `<p>يُعد علم التفسير مفتاحاً لفهم كلام الله عز وجل، ويبدأ الدرس بتعريف التفسير لغةً واصطلاحاً. ففي اللغة، يدور معناه حول الكشف والبيان والإيضاح، أما في الاصطلاح الشرعي فهو العلم الذي يُعنى ببيان معاني القرآن الكريم وتوضيح دلالاته. وقد مرّ هذا العلم الشريف بمراحل تاريخية متدرجة حتى وصل إلينا بشكله الحالي.</p><p>المرحلة الأولى هي مرحلة "الفهم والتلقي"، وقد انقسمت إلى فترتين: الأولى عهد النبي ﷺ، حيث كان الصحابة يتلقون القرآن غضاً طرياً، وكان النبي ﷺ يبين لهم ما قد يُشكل عليهم من المعاني، كما حدث عندما فسر لهم "الظلم" في سورة الأنعام بـ "الشرك". والفترة الثانية هي عهد الصحابة، حيث تميزوا بسلامة القصد، ومشاهدة التنزيل، والفصاحة العربية، وكان منهجهم ألا يتجاوزوا عشر آيات حتى يتعلموا ما فيها من العلم والعمل.</p><p>أما المرحلة الثانية فهي "الكتابة والتدوين"، وبدأت بتدوين التفسير كجزء من أبواب الحديث النبوي على يد علماء مثل شعبة بن الحجاج، ثم تطور الأمر في الفترة اللاحقة لاستقلال التفسير كعلم قائم بذاته يُفسر الآيات سورة سورة، كما فعل ابن جرير الطبري.</p><p>وفيما بعد، تمايزت مناهج المفسرين إلى مدرستين رئيستين: الأولى "التفسير بالمأثور"، وهو التفسير الذي يعتمد على الآثار المنقولة (القرآن، السنة، أقوال الصحابة والتابعين) وهو أعلى الطرق منزلة. والمدرسة الثانية "التفسير بالرأي"، وهو يعتمد على الاجتهاد، وينقسم إلى "محمود" (مبني على علم) و"مذموم" (مبني على جهل وهوى).</p>`,
                mcq: [{ q: "أعلى طرق التفسير منزلة هو التفسير بـ:", opts: ["الرأي المحمود", "المأثور", "اللغة العربية"], ans: 1 }, { q: "كان الصحابة لا يتجاوزون ... آيات حتى يتعلموا ما فيها:", opts: ["خمس", "عشر", "عشرين"], ans: 1 }, { q: "من أبرز علماء مرحلة استقلال التفسير وتدوينه كعلم مستقل:", opts: ["ابن جرير الطبري", "سفيان بن عيينة", "ابن مسعود"], ans: 0 }],
                tf: [{ q: "بدأ تدوين التفسير مستقلاً عن الحديث منذ عهد النبي ﷺ.", ans: false }, { q: "التفسير بالرأي المحمود هو الاجتهاد الصادر عن هوى وجهل.", ans: false }, { q: "تميز تفسير الصحابة بأنهم أهل اللسان العربي وشهدوا التنزيل.", ans: true }]
            },
            {
                id: 2, type: 'text', title: "الدرس (2): أهمية علم التفسير وضوابطه",
                summary: `<p>يتناول هذا الدرس مكانة علم التفسير العالية، حيث يستمد شرفه من شرف موضوعه وهو كلام الله تعالى. وتبرز أهميته في أنه السبيل لتدبر القرآن الذي أمرنا الله به في قوله: {كِتَابٌ أَنزَلْنَاهُ إِلَيْكَ مُبَارَكٌ لِّيَدَّبَّرُوا آيَاتِهِ}، ولأنه الطريق لتحقيق الخيرية المذكورة في حديث "خيركم من تعلم القرآن وعلمه".</p><p>ولأن التفسير قولٌ على الله، فقد وضع العلماء ضوابط صارمة للمفسر حتى لا يقع في الانحراف. أول هذه الضوابط وأهمها "سلامة العقيدة"؛ لأن فساد العقيدة يؤدي إلى تحريف معاني القرآن لتوافق الهوى.</p><p>ثانياً: الاعتماد على أصح طرق التفسير بالترتيب: تفسير القرآن بالقرآن (وهو الأقوى)، ثم تفسير القرآن بالسنة النبوية (لأن الرسول هو المبين للقرآن)، ثم بأقوال الصحابة (لأنهم أعلم الناس بالتنزيل)، ثم بأقوال التابعين.</p><p>ثالثاً: معرفة اللغة العربية ومراعاة سياق الآية؛ فالسياق هو الموجه للمعنى، وإهماله قد يؤدي لفهم قاصر أو مغلوط، كما في قوله تعالى {ذُقْ إِنَّكَ أَنتَ الْعَزِيزُ الْكَرِيمُ}، فالسياق هنا يفيد الإهانة والتهكم لا المدح. فالمفسر الناجح هو الذي يجمع بين العلم الشرعي واللغوي وضوابط العقيدة السليمة.</p>`,
                mcq: [{ q: "أصح طرق التفسير التي يجب أن يبدأ بها المفسر هي:", opts: ["تفسير القرآن بالسنة", "تفسير القرآن بالقرآن", "تفسير القرآن بالرأي"], ans: 1 }, { q: "قوله تعالى {ذُقْ إِنَّكَ أَنتَ الْعَزِيزُ الْكَرِيمُ} سياقها يدل على:", opts: ["المدح والثناء", "التحقير والتهكم", "الوصف الحقيقي"], ans: 1 }, { q: "من ضوابط المفسر التي تحميه من حمل الألفاظ على هواه:", opts: ["سلامة العقيدة", "كثرة الحفظ", "جمال الخط"], ans: 0 }],
                tf: [{ q: "يجوز لمن يتقن اللغة العربية فقط أن يفسر القرآن دون الرجوع للسنة.", ans: false }, { q: "تفسير القرآن بأقوال الصحابة مقدم على تفسيره بأقوال التابعين.", ans: true }, { q: "مراعاة السياق ضروري لفهم مراد الله في الآيات.", ans: true }]
            },
            {
                id: 3, type: 'text', title: "الدرس (3): أبرز المؤلفات الموثوقة في التفسير",
                summary: `<p>يستعرض الدرس المكتبة التفسيرية الإسلامية، مرشداً الطالب إلى أهم الكتب الموثوقة التي يجب الرجوع إليها.</p><p>أولاً: "جامع البيان عن تأويل آي القرآن" للإمام الطبري (ت 310هـ)، وهو "شيخ المفسرين"، وكتابه أصح التفاسير وأجمعها، يعتمد على ذكر الأسانيد وأقوال السلف.</p><p>ثانياً: "تفسير القرآن العظيم" لابن كثير (ت 774هـ)، ويأتي في المرتبة الثانية، ويتميز بأنه من أفضل كتب التفسير بالمأثور، حيث يفسر الآية بالآية، ثم بالحديث، ثم بأقوال الصحابة.</p><p>ثالثاً: "الدر المنثور في التفسير بالمأثور" للسيوطي (ت 911هـ)، وهو موسوعة حديثية جمعت الروايات المنقولة في التفسير.</p><p>رابعاً: "تيسير الكريم الرحمن" للعلامة السعدي (ت 1376هـ)، وهو تفسير معاصر يتميز بالسهولة، والتركيز على المعنى الإجمالي، واستنباط الفوائد السلوكية والتربوية، وخلوه من التعقيد.</p><p>خامساً: "أضواء البيان" للشنقيطي (ت 1393هـ)، وتميز بميزتين: تفسير القرآن بالقرآن، والعناية الفائقة بالأحكام الفقهية والمسائل الأصولية. هذه الكتب تمثل مراجع أساسية لكل باحث وطالب علم.</p>`,
                mcq: [{ q: "الكتاب الذي يُعد أصح التفاسير ويعتمد عليه المفسرون هو:", opts: ["تفسير الطبري", "تفسير السعدي", "تفسير الجلالين"], ans: 0 }, { q: "يتميز تفسير \"أضواء البيان\" للشنقيطي بـ:", opts: ["جمع الروايات الضعيفة", "العناية بالأحكام الفقهية وتفسير القرآن بالقرآن", "الاختصار الشديد"], ans: 1 }, { q: "مؤلف كتاب \"تفسير القرآن العظيم\" هو:", opts: ["جلال الدين السيوطي", "ابن كثير الدمشقي", "عبد الرحمن السعدي"], ans: 1 }],
                tf: [{ q: "كتاب \"الدر المنثور\" للسيوطي يعتمد على التفسير بالرأي العقلي.", ans: false }, { q: "يتميز تفسير السعدي بذكر المعنى الإجمالي بأسلوب سهل وميسر.", ans: true }, { q: "منهج ابن كثير في التفسير يبدأ بذكر الأحاديث قبل الآيات المناسبة.", ans: false }]
            },
            {
                id: 4, type: 'text', title: "الدرس (4): التقنية في خدمة القرآن الكريم وتفسيره",
                summary: `<p>يبرز هذا الدرس دور التقنية الحديثة في تيسير الوصول إلى القرآن وعلومه، مستعرضاً نماذج رقمية موثوقة يجب اعتمادها بدلاً من المصادر المجهولة.</p><p>أولاً: تطبيق "مصحف مدرستي"، وهو تطبيق رسمي تشرف عليه وزارة التعليم، يربط الطالب بمنهجه الدراسي، ويتيح التلاوة، والتفسير، وتسجيل الصوت لإرساله للمعلم كواجب مدرسي.</p><p>ثانياً: إصدارات "مجمع الملك فهد لطباعة المصحف الشريف"، الذي لم يكتفِ بالطباعة الورقية، بل أنشأ 16 موقعاً متخصصاً، وتطبيقات تقدم نسخاً رقمية عالية الدقة، مع تفاسير وترجمات ومواد لعلوم القرآن، مما يجعله مرجعاً عالمياً موثوقاً.</p><p>ثالثاً: تطبيق "آيات" التابع لجامعة الملك سعود، وهو برنامج شامل يتميز بواجهة تتيح خيارات متعددة مثل: التصفح، البحث عن الكلمات، الاستماع لنخبة من القراء، وتوفير مكتبة تفاسير يمكن الوصول إليها بضغطة زر. يهدف الدرس إلى توعية الطالب بأهمية تحري "الموثوقية" في المصادر الرقمية، فليس كل ما على الإنترنت صحيح، ولذلك تم تحديد هذه المصادر الرسمية لضمان تلقي العلم الشرعي الصحيح.</p>`,
                mcq: [{ q: "التطبيق الذي يتيح للطالب حل الواجبات وإرسال التسجيل الصوتي للمعلم هو:", opts: ["آيات", "مصحف مدرستي", "الباحث القرآني"], ans: 1 }, { q: "الجهة المشرفة على تطبيق وبرنامج \"آيات\" هي:", opts: ["وزارة التعليم", "جامعة الملك سعود", "مجمع الملك فهد"], ans: 1 }, { q: "عدد المواقع المتخصصة التي أنشأها مجمع الملك فهد لخدمة القرآن:", opts: ["10 مواقع", "16 موقعاً", "5 مواقع"], ans: 1 }],
                tf: [{ q: "جميع تطبيقات القرآن الموجودة في متاجر الهواتف موثوقة وصحيحة.", ans: false }, { q: "يقدم مجمع الملك فهد خدمات رقمية تشمل ترجمات معاني القرآن.", ans: true }, { q: "تتيح التقنية الحديثة الوصول السريع لكتب التفسير المعتمدة.", ans: true }]
            },
            {
                id: 5, type: 'text', title: "الدرس (5): تفسير سورة الفاتحة",
                summary: `<p>سورة الفاتحة هي أعظم سور القرآن، مكية، وآياتها سبع. افتتح الدرس ببيان فضائلها: فهي "نور" لم يؤته نبي قبل محمد ﷺ ، وهي "رقية" شافية، وهي أساس "المناجاة" في الصلاة حيث يقسم الله الصلاة بينه وبين عبده.</p><p>في معناها الإجمالي: بدأت بالثناء على الله (رب العالمين) أي المربي والمالك، (الرحمن الرحيم) ذو الرحمة العامة والخاصة، (مالك يوم الدين) أي يوم الجزاء، مما يزرع في القلب الخوف والرجاء.</p><p>ثم انتقلت للعهد الوثيق: {إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ}، وفيها حصر العبادة والاستعانة بالله وحده، فالعبادة غاية والاستعانة وسيلة. وختمت بالدعاء بطلب الهداية إلى (الصراط المستقيم)، وهو الطريق الواضح الموصل للجنة.</p><p>وقد صنف الدرس الناس في هذا الطريق لثلاثة أصناف: 1. المنعم عليهم: أهل الحق والعمل. 2. المغضوب عليهم: من عرفوا الحق وتركوه (كاليهود). 3. الضالون: من عبدوا الله بجهل (كالنصارى). من فوائدها: أن "الرب" إذا أطلق فهو الله، والعبادة تتضمن كمال الحب والذل، وأهمية الدعاء بالهداية لأنها نعمة وتوفيق من الله.</p>`,
                mcq: [{ q: "المقصود بـ (يوم الدين) في السورة:", opts: ["يوم الجمعة", "يوم الجزاء والحساب", "يوم العيد"], ans: 1 }, { q: "الذين عرفوا الحق ولم يتبعوه وصفهم الله بـ:", opts: ["المغضوب عليهم", "الضالين", "المنعم عليهم"], ans: 0 }, { q: "قدم الله \"العبادة\" على \"الاستعانة\" في الآية لأن:", opts: ["الاستعانة أهم", "العبادة هي الغاية والمقصود", "السياق اللفظي"], ans: 1 }],
                tf: [{ q: "سورة الفاتحة هي أول سورة نزلت كاملة في القرآن.", ans: true }, { q: "(الضالون) هم الذين تركوا الحق عن عمد وعناد.", ans: false }, { q: "قراءة الفاتحة ركن من أركان الصلاة لا تصح إلا بها.", ans: true }]
            },
            {
                id: 6, type: 'text', title: "الدرس (6): تفسير سورة يونس (3-10)",
                summary: `<p>ترسخ هذه الآيات عقيدة التوحيد من خلال براهين كونية. يبدأ الله بتقرير ربوبيته: {خَلَقَ السَّمَاوَاتِ وَالْأَرْضَ فِي سِتَّةِ أَيَّامٍ}، ثم استوى على العرش، ويدبر الأمر، فلا يشفع أحد عنده إلا بإذنه، وهذا دليل قاطع على استحقاقه للعبادة وحده.</p><p>ثم تنتقل الآيات لإثبات "البعث والجزاء"، مؤكدة أنه كما بدأ الخلق سيعيده ليجزي المؤمنين بالقسط (العدل)، ويعاقب الكافرين. وتلفت الأنظار لآيات الكون: جعل الشمس ضياءً والقمر نوراً وقدره منازل؛ والحكمة من ذلك "لتعلموا عدد السنين والحساب"، فليست مخلوقة عبثاً.</p><p>وتقسم الآيات الناس إلى فريقين: فريق "الغافلين" الذين رضوا بالدنيا واطمأنوا بها ونسوا الآخرة، فمأواهم النار. وفريق "المؤمنين" الذين يعملون الصالحات، فيهديهم ربهم، ولهم جنات النعيم. ومن لطائف وصف أهل الجنة أن دعواهم فيها تسبيح، وتحيتهم سلام، وآخر دعواهم الحمد لله. من الفوائد: إثبات الشفاعة بإذن الله، ومشروعية تعلم الحساب والفلك، وأن الأمن والاطمئنان بالدنيا فقط مذموم.</p>`,
                mcq: [{ q: "الحكمة من تقدير منازل القمر كما ذكرت الآيات:", opts: ["للإنارة ليلاً فقط", "لتعلموا عدد السنين والحساب", "لزينة السماء"], ans: 1 }, { q: "وصف الله الذين لا يرجون لقاءه بأنهم:", opts: ["رضوا بالحياة الدنيا واطمأنوا بها", "يجاهدون في سبيله", "يتفكرون في الخلق"], ans: 0 }, { q: "آخر دعاء أهل الجنة هو:", opts: ["سبحانك اللهم", "الحمد لله رب العالمين", "سلام عليكم"], ans: 1 }],
                tf: [{ q: "خلق الله السماوات والأرض في ثمانية أيام.", ans: false }, { q: "الشفاعة يوم القيامة تكون مفتوحة للجميع دون إذن.", ans: false }, { q: "الركون إلى الدنيا والغفلة عن آيات الله سبب لدخول النار.", ans: true }]
            },
            {
                id: 7, type: 'text', title: "الدرس (7): تفسير سورة يونس (26-33)",
                summary: `<p>توازن الآيات بين مصير المحسنين والمسيئين. فللذين أحسنوا "الحسنى" وهي الجنة، و"زيادة" فسرها النبي ﷺ بالنظر إلى وجه الله الكريم، ووجوههم لا يرهقها "قتر" (غبار) ولا ذلة. أما الكسبَة للسيئات فجزاؤهم بمثلها، وتعلو وجوههم الذلة كأنما أغشيت قطعاً من الليل المظلم.</p><p>ثم تعرض مشهداً مهيباً من يوم القيامة، حيث يحشر الله المشركين وشركاءهم (الآلهة المزعومة)، فيقع "التزييل" (التفريق) بينهم، ويتبرأ الشركاء من عبادهم قائلين: {مَا كُنتُمْ إِيَّانَا تَعْبُدُونَ}، وتكون شهادة الله كافية بينهم.</p><p>وتختتم الآيات بحجة دامغة على المشركين بأسلوب الاستفهام: من يرزقكم؟ من يملك السمع والأبصار؟ من يخرج الحي من الميت؟ من يدبر الأمر؟ فسيقرون بأنه "الله" (توحيد الربوبية)، فيلزمهم حينئذ أن يتقوه ويفردوه بالعبادة (توحيد الألوهية). من الفوائد: إثبات رؤية المؤمنين لربهم، وأن الجزاء من جنس العمل، وأن توحيد الربوبية يستلزم توحيد الألوهية.</p>`,
                mcq: [{ q: "المقصود بـ (الزيادة) في قوله تعالى {لِّلَّذِينَ أَحْسَنُوا الْحُسْنَىٰ وَزِيَادَةٌ}:", opts: ["القصور والحور العين", "النظر إلى وجه الله الكريم", "طول العمر في الجنة"], ans: 1 }, { q: "معنى كلمة (قتر) في الآيات:", opts: ["سواد وغبار", "نور وضياء", "حزن وبكاء"], ans: 0 }, { q: "احتج الله على المشركين لإثبات توحيد الألوهية بإقرارهم بـ:", opts: ["توحيد الأسماء والصفات", "توحيد الربوبية", "الإيمان بالكتب"], ans: 1 }],
                tf: [{ q: "الشركاء (الأصنام) سيدافعون عن المشركين يوم القيامة.", ans: false }, { q: "الله يضاعف الحسنات ويجازي السيئة بمثلها عدلاً منه.", ans: true }, { q: "الآيات تثبت أن المشركين كانوا ينكرون وجود الله تماماً.", ans: false }]
            },
            {
                id: 8, type: 'text', title: "الدرس (8): تفسير سورة يونس (62-70)",
                summary: `<p>يفتح الله للمؤمنين باب الأمل والسكينة بتعريف "أولياء الله": هم الذين جمعوا بين صفتين {آَمَنُوا وَكَانُوا يَتَّقُونَ}. وجزاؤهم: {لَا خَوْفٌ عَلَيْهِمْ وَلَا هُمْ يَحْزَنُونَ}، ولهم "البشرى" في الدنيا (كالرؤيا الصالحة والثناء الحسن) وفي الآخرة (الجنة).</p><p>ثم يُسلي الله نبيه ﷺ: {وَلَا يَحْزُنكَ قَوْلُهُمْ}، مؤكداً أن العزة لله جميعاً. ويرد على المشركين الذين ادعوا أن لله ولداً، مبيناً تنزهه عن ذلك لسببين: أنه "الغني" عن خلقه، وأنه "مالك" لكل ما في السماوات والأرض، فكيف يكون المملوك ولداً للمالك؟! ويتحداهم بطلب "السلطان" (الدليل) على افترائهم.</p><p>ويذكر نعمته في خلق الليل للسكن والنهار للإبصار. ويختم بوعيد المفترين بأن متاعهم في الدنيا قليل ومؤقت، ثم مرجعهم للعذاب الشديد. من الفوائد: الولاية لا تنال إلا بالإيمان والتقوى، والعزة تطلب من الله، واستخدام "السلطان" بمعنى الحجة العلمية يدل على قوة العلم في الإقناع.</p>`,
                mcq: [{ q: "\"أولياء الله\" كما عرفتهم الآيات هم:", opts: ["الذين تركوا الدنيا واعتزلوا الناس", "الذين آمنوا وكانوا يتقون", "أصحاب الكرامات الخارقة"], ans: 1 }, { q: "الحكمة من جعل الله الليل كما ورد في الآيات:", opts: ["للعمل والكسب", "للسكن والراحة", "للخوف والوحشة"], ans: 1 }, { q: "وصف الله قول المشركين \"اتخذ الله ولداً\" بأنه:", opts: ["اجتهاد مقبول", "افتراء وكذب بلا سلطان", "تعظيم لله"], ans: 1 }],
                tf: [{ q: "الخوف والحزن منفيان عن أولياء الله في الدنيا والآخرة.", ans: true }, { q: "يجوز الحزن الشديد الذي يؤدي لليأس بسبب قول المكذبين.", ans: false }, { q: "الحجة العلمية والدليل سماه الله في الآيات \"سلطاناً\".", ans: true }]
            },
            {
                id: 9, type: 'text', title: "الدرس (9): تفسير سورة هود (96-108)",
                summary: `<p>تستعرض هذه الآيات جانباً مهيباً من قصص الأنبياء ومشاهد يوم القيامة، لترسيخ العقيدة في نفوس الناشئة. تبدأ الآيات بذكر قصة موسى عليه السلام، الذي أرسله الله بالآيات البينة والحجة القوية "سلطان مبين" إلى فرعون وملئه. لكن فرعون استخف قومه فأطاعوه، وهنا يصور القرآن مشهداً مرعباً للقيادة الفاسدة؛ فكما كان فرعون يقودهم في الضلال في الدنيا، فإنه سيقودهم يوم القيامة (يَقْدُمُ قَوْمَهُ) ليوردهم النار، وبئس المورد الذي يردونه.</p><p>تنتقل الآيات لبيان سنة الله في الأمم السابقة، فتلك القرى التي ظلمت، أخذها الله أخذ عزيز مقتدر، فمنها ما بقي أثره شاهداً (قائم)، ومنها ما مُحي تماماً كالزرع المحصود (حصيد). وتؤكد الآيات أن الله لم يظلمهم، بل هم ظلموا أنفسهم بالشرك، وما أغنت عنهم آلهتهم المزعومة شيئاً لما جاء أمر الله، بل زادتهم خساراً وهلاكاً (تتبيب).</p><p>ثم تأخذنا الآيات إلى مشهد "اليوم المشهود" (يوم القيامة)، حيث يجمع الله الأولين والآخرين، ويسود الصمت المهيب فلا تتكلم نفس إلا بإذنه. ينقسم الناس حينها إلى فريقين لا ثالث لهما: شقي وسعيد. أما الأشقياء فمقرهم النار، يُسمع لهم فيها أصوات مرعبة من شدة الكرب، وهي "الزفير" (إخراج النفس) و"الشهيق" (رد النفس)، خالدين فيها ما دامت السماوات والأرض. وأما السعداء ففي الجنة، ينعمون بعطاء الله الذي لا ينقطع (غير مجذوذ).</p><p>من الفوائد والدروس: خطورة اتباع قادة السوء والضلال، وأن الجزاء من جنس العمل، وإثبات مشيئة الله المطلقة في الخلود، وأن العبرة في القصص ليست للتسلية بل للاتعاظ والاعتبار لمن خاف عذاب الآخرة.</p>`,
                mcq: [{ q: "معنى قوله تعالى (الورد المورود) في سياق قصة فرعون:", opts: ["الماء العذب", "مدخل النار", "قصور الجنة"], ans: 1 }, { q: "وصف الله يوم القيامة في الآيات بأنه يوم:", opts: ["قصير", "مشهود", "مظلم"], ans: 1 }, { q: "معنى كلمة (غير مجذوذ) في وصف عطاء أهل الجنة:", opts: ["غير مقطوع", "غير كثير", "غير معلوم"], ans: 0 }],
                tf: [{ q: "قاد فرعون قومه إلى النجاة في الدنيا والآخرة.", ans: false }, { q: "الأصنام دفعت العذاب عن عابديها لما نزل بهم.", ans: false }, { q: "يوم القيامة لا تتكلم فيه نفس إلا بإذن الرحمن.", ans: true }]
            },
            {
                id: 10, type: 'text', title: "الدرس (10): تفسير سورة هود (112-123)",
                summary: `<p>يختتم الله سورة هود بتوجيهات حاسمة للنبي ﷺ وللمؤمنين، محورها "الاستقامة". يأمر الله نبيه ومن تاب معه أن يستقيموا كما أمروا، بلا غلو ولا تقصير، وينهاهم عن الطغيان (تجاوز الحد). ويحذر تحذيراً شديداً من "الركون" إلى الظالمين، وهو الميل إليهم بالمودة أو المداهنة أو الرضا بأفعالهم، لأن عاقبة ذلك هي النار وفقدان نصرة الله.</p><p>ثم يرشد الله إلى الزاد الذي يعين على الاستقامة، وهو "إقامة الصلاة" في طرفي النهار (الصباح والمساء) وزلفاً من الليل، مؤكداً قاعدة عظيمة في الإسلام: {إِنَّ الْحَسَنَاتِ يُذْهِبْنَ السَّيِّئَاتِ}، فالأعمال الصالحة كالصلاة تكفر الذنوب الصغائر. ويأمر بالصبر، فالله لا يضيع أجر المحسنين.</p><p>تتطرق الآيات لسنة اجتماعية، وهي أن الأمم لا تهلك وفيها مصلحون (أولو بقية) ينهون عن الفساد، لكنهم كانوا قليلاً فنجاهم الله، وأخذ الظالمين العذاب. وتوضح الآيات حكمة الله في "الاختلاف"، فلو شاء لجعل الناس أمة واحدة، لكنه خلقهم ليتميز من يختار الحق ممن يختار الباطل.</p><p>وفي الختام، يبين الله أن قصص الرسل إنما هي "تثبيت" لفؤاد النبي ﷺ، وموعظة للمؤمنين. ويأمر النبي أن يتوكل على الله وحده، فهو الذي بيده غيب السماوات والأرض، وإليه يرجع الأمر كله، وما ربك بغافل عما يعملون.</p>`,
                mcq: [{ q: "معنى قوله تعالى (لا تركنوا) إلى الذين ظلموا:", opts: ["لا تحاربوهم", "لا تميلوا إليهم", "لا تدعوهم"], ans: 1 }, { q: "القاعدة الشرعية المستنبطة من قوله (إن الحسنات يذهبن السيئات) هي:", opts: ["الطاعات تكفر الذنوب", "الذنوب تبطل الطاعات", "السيئة تمحو الحسنة"], ans: 0 }, { q: "الغاية من ذكر قصص الرسل للنبي ﷺ كما في الآيات:", opts: ["معرفة الأنساب", "تثبيت فؤاده", "التسلية والترفيه"], ans: 1 }],
                tf: [{ q: "الاستقامة تعني الثبات على الدين وموافقة الأمر الشرعي دون غلو.", ans: true }, { q: "يجوز للمسلم أن يميل بقلبه للظالمين ويرضى بفعالهم.", ans: false }, { q: "الصلاة تعتبر من أكبر الحسنات الماحية للخطايا.", ans: true }]
            },
            {
                id: 11, type: 'text', title: "الدرس (11): تفسير سورة يوسف (46-57)",
                summary: `<p>تتناول هذه الآيات مرحلة التمكين ليوسف عليه السلام بعد الابتلاء. تبدأ بمشهد السجن، حيث جاء "الناجي" يستفتي يوسف في رؤيا الملك (سبع بقرات سمان يأكلهن سبع عجاف...). يوسف عليه السلام، بصفته "الصديق" والعالم الناصح، لم يكتفِ بتفسير الرؤيا، بل قدم "خطة اقتصادية" لإنقاذ مصر: زراعة دؤوبة لسبع سنين (سنوات الخصب)، وادخار المحصول في سنبله (ليحفظه من التلف)، ثم استهلاكه بحكمة في السبع الشداد (سنوات القحط).</p><p>لما علم الملك بحكمته، طلبه، لكن يوسف أبى الخروج حتى تثبت براءته، لتظهر عفته ونزاهته أمام الجميع. وهنا "حصحص الحق" (ظهر وانكشف) باعتراف امرأة العزيز: {أَنَا رَاوَدتُّهُ عَن نَّفْسِهِ}.</p><p>بعد ظهور البراءة، قربه الملك وقال: {إِنَّكَ الْيَوْمَ لَدَيْنَا مَكِينٌ أَمِينٌ}. وهنا طلب يوسف الولاية قائلاً: {اجْعَلْنِي عَلَى خَزَائِنِ الْأَرْضِ}، معللاً ذلك بكفاءته: {إِنِّي حَفِيظٌ عَلِيمٌ}. فهو أمين على الخزائن، عليم بتدبيرها.</p><p>تختم الآيات ببيان أن هذا التمكين كان رحمة من الله، وجزاءً لإحسانه، مع التأكيد على أن أجر الآخرة خير وأبقى للذين آمنوا وكانوا يتقون. من الفوائد: جواز طلب المنصب لمن يثق بقدرته وأمانته وكفاءته، أهمية التخطيط المستقبلي والادخار (الأمن الغذائي)، وأن التقوى والصبر عاقبتهما التمكين.</p>`,
                mcq: [{ q: "الوصف الذي وصف به يوسف نفسه لطلب تولي الخزائن:", opts: ["قوي أمين", "حفيظ عليم", "غني كريم"], ans: 1 }, { q: "معنى كلمة (حصـحص) في قوله (الآن حصحص الحق):", opts: ["ضاع واختفى", "ظهر وانكشف", "التبس وغمض"], ans: 1 }, { q: "الخطة التي وضعها يوسف عليه السلام لمواجهة القحط اعتمدت على:", opts: ["زيادة الضرائب", "الادخار وحفظ النعمة", "طلب المساعدات الخارجية"], ans: 1 }],
                tf: [{ q: "خرج يوسف من السجن فوراً بمجرد أن طلبه الملك.", ans: false }, { q: "يجوز طلب الولاية (المنصب) لمن علم من نفسه القدرة والأمانة.", ans: true }, { q: "النفس البشرية أمارة بالسوء إلا ما رحم الله وعصم.", ans: true }]
            },
            {
                id: 12, type: 'text', title: "الدرس (12): تفسير سورة يوسف (102-111)",
                summary: `<p>في ختام سورة يوسف، يوجه الله الخطاب لنبيه محمد ﷺ، مبيناً أن هذه القصة من "أنباء الغيب" التي أوحاها الله إليه، فلم يكن حاضراً مع إخوة يوسف حين دبروا المؤامرة، وهذا دليل صدق نبوته. ثم يواسي الله نبيه بأن حرصه الشديد على هداية الناس لن يجعل أكثرهم يؤمنون، لأن الهداية بيد الله.</p><p>تشير الآيات إلى ظاهرة خطيرة وهي "الشرك مع الإيمان"، في قوله: {وَمَا يُؤْمِنُ أَكْثَرُهُم بِاللَّهِ إِلَّا وَهُم مُّشْرِكُونَ}، مما يدل على أن الإقرار بربوبية الله (الخلق والرزق) لا يكفي للنجاة ما لم يقترن بإفراد الله بالعبادة (توحيد الألوهية).</p><p>ثم يرسم الله منهج الدعوة للنبي وأتباعه: {قُلْ هَذِهِ سَبِيلِي أَدْعُوا إِلَى اللَّهِ عَلَى بَصِيرَةٍ}، أي على علم ويقين وحجة، وليس على جهل أو عاطفة مجردة.</p><p>وتؤكد الآيات أن النصر قد يتأخر "استدراجاً للظالمين وتمحيصاً للمؤمنين"، حتى إذا بلغ اليأس مداه (استيأس الرسل)، جاء نصر الله، فنجي من يشاء. وتختم السورة بتقرير أن في قصص الأنبياء "عبرة لأولي الألباب"، وأن القرآن ليس حديثاً "مفتري" (مكذوباً)، بل هو تصديق للكتب السماوية، وتفصيل لكل شيء، وهدى ورحمة.</p>`,
                mcq: [{ q: "الشرط الأساسي للدعوة إلى الله كما في قوله (أدعو إلى الله على ...):", opts: ["مال", "بصيرة وعلم", "قوة وسلطة"], ans: 1 }, { q: "معنى قوله تعالى (استيأس الرسل):", opts: ["فقدوا الأمل في إيمان أقوامهم", "يئسوا من رحمة الله", "ماتوا جميعاً"], ans: 0 }, { q: "وصف الله قصص القرآن في ختام السورة بأنها:", opts: ["عبرة لأولي الألباب", "أساطير الأولين", "تسلية للناس"], ans: 0 }],
                tf: [{ q: "توحيد الربوبية يكفي لدخول الجنة دون توحيد الألوهية.", ans: false }, { q: "القرآن الكريم مصدق لما بين يديه من الكتب السماوية ومهيمن عليها.", ans: true }, { q: "الأمن من مكر الله وعذابه صفة مذمومة حذرت منها الآيات.", ans: true }]
            },
            {
                id: 13, type: 'text', title: "الدرس (13): تفسير سورة الرعد (8-15)",
                summary: `<p>تتجلى في هذه الآيات عظمة "العلم الإلهي" و"القدرة الربانية". فالله يعلم ما تحمل كل أنثى (من إنسان أو حيوان)، ويعلم ما تنقصه الأرحام (السقط) أو تزداده (في المدة أو العدد). هو عالم الغيب والشهادة، الكبير المتعال، يستوي عنده السر والجهر، والظلام والنور.</p><p>ومن مظاهر حفظه لعباده أن جعل لكل إنسان "معقبات" (ملائكة يتعاقبون بالليل والنهار) يحفظونه بأمر الله من الأقدار التي لم تُكتب عليه.</p><p>وتقرر الآيات قانوناً اجتماعياً ثابتاً: {إِنَّ اللَّهَ لَا يُغَيِّرُ مَا بِقَوْمٍ حَتَّى يُغَيِّرُوا مَا بِأَنفُسِهِمْ}، فزوال النعم سببه الذنوب، وتغير الأحوال يبدأ من تغير النفوس.</p><p>ومن آيات الكون الدالة على عظمته: "البرق" الذي يجمع بين الخوف (من الصواعق) والطمع (في المطر)، و"الرعد" الذي يسبح بحمد الله، والملائكة تسبح من خيفته.</p><p>تختم الآيات ببيان حقيقة التوحيد: أن دعوة الحق لله وحده، أما الذين يدعون من دونه (الأصنام والأولياء) فلا يستجيبون لهم بشيء، ومثلهم كمثل العطشان الذي يمد يده للماء من بعيد ليروي عطشه، وما هو ببالغه! وأن كل من في الكون يسجد لله، المؤمن طوعاً، والكافر كرهاً (بخضوع نظامه البيولوجي والكوني لله).</p>`,
                mcq: [{ q: "معنى (المعقبات) في قوله تعالى (له معقبات من بين يديه):", opts: ["الشياطين", "الملائكة الحفظة", "النجوم"], ans: 1 }, { q: "القانون الإلهي في تغيير النعم مرتبط بـ:", opts: ["تغير ما في نفوس الناس", "تغير الزمان", "تغير المكان"], ans: 0 }, { q: "تسبيح الرعد بحمد الله هو تسبيح:", opts: ["حقيقي دال على الخضوع", "مجازي", "خيالي"], ans: 0 }],
                tf: [{ q: "الله يعلم ما تغيض الأرحام وما تزداد.", ans: true }, { q: "دعاء غير الله كمن يبسط كفيه إلى الماء ليبلغ فاه فلا يبلغه.", ans: true }, { q: "الكافر لا يسجد لله مطلقاً لا طوعاً ولا كرهاً.", ans: false }]
            },
            {
                id: 14, type: 'text', title: "الدرس (14): تفسير سورة الرعد (19-29)",
                summary: `<p>تعقد الآيات مقارنة بين "أولي الألباب" (أصحاب العقول السليمة) وبين "العميان" (أهل الضلال). فالمؤمن يعلم أن القرآن حق، أما الكافر فهو أعمى البصيرة.</p><p>ثم تفصل الآيات صفات أولي الألباب في ثماني خصال: الوفاء بعهد الله، عدم نقض الميثاق، صلة ما أمر الله به أن يوصل (الأرحام)، خشية الله، الخوف من سوء الحساب، الصبر ابتغاء وجه الله، إقامة الصلاة، والإنفاق سراً وعلانية، ودفع السيئة بالحسنة (يدرؤون بالحسنة السيئة). وجزاؤهم "جنات عدن" (إقامة) يدخلونها مع صالحي آبائهم وأزواجهم وذرياتهم، والملائكة ترحب بهم.</p><p>في المقابل، تذكر صفات الأشقياء: نقض العهد، قطع الأرحام، والإفساد في الأرض. وجزاؤهم اللعنة وسوء الدار.</p><p>تؤكد الآيات أن الرزق بيد الله (يبسط ويقدر)، وأن طمأنينة القلوب لا تكون إلا بذكر الله: {أَلَا بِذِكْرِ اللَّهِ تَطْمَئِنُّ الْقُلُوبُ}. وترد على الكفار الذين طلبوا المعجزات الحسية، بأن الهداية ليست بالمعجزات بل بمشيئة الله وإنابة العبد إليه.</p>`,
                mcq: [{ q: "معنى (جنات عدن):", opts: ["جنات إقامة دائمة", "بساتين مؤقتة", "حدائق الدنيا"], ans: 0 }, { q: "قوله تعالى (يدرؤون بالحسنة السيئة) يعني:", opts: ["يدفعون السيئة بالإحسان", "يردون السيئة بمثلها", "ينسون السيئة"], ans: 0 }, { q: "تطمئن القلوب وتسكن بـ:", opts: ["جمع المال", "ذكر الله", "السفر والترحال"], ans: 1 }],
                tf: [{ q: "العمى الحقيقي المذكور في القرآن هو عمى البصر.", ans: false }, { q: "صلة الرحم والوفاء بالعهد من صفات أولي الألباب.", ans: true }, { q: "بسط الرزق وتضييقه خاضع لمشيئة الله وحكمته.", ans: true }]
            },
            {
                id: 15, type: 'text', title: "الدرس (15): تفسير سورة إبراهيم (24-31)",
                summary: `<p>يضرب الله في هذه الآيات مثلاً رائعاً للكلمة الطيبة والكلمة الخبيثة لتقريب المعاني العقلية في صور حسية. فالكلمة الطيبة (وهي كلمة التوحيد "لا إله إلا الله") كشجرة طيبة (النخلة)، أصلها ثابت في الأرض، وفرعها ممتد في السماء، تؤتي ثمارها النافعة في كل حين بإذن ربها؛ وكذلك المؤمن، إيمانه راسخ وعمله الصالح يصعد إلى الله دائماً. أما الكلمة الخبيثة (كلمة الكفر) فهي كشجرة خبيثة (الحنظل)، "اجتثت" (اقتلعت) من فوق الأرض، ليس لها "قرار" (ثبات)؛ وكذلك الكافر لا ثبات له ولا عمل مقبول.</p><p>ثم تبين الآيات سنة الله في "التثبيت"، فالله يثبت الذين آمنوا بالقول الثابت في الحياة الدنيا (عند الفتن) وفي الآخرة (عند سؤال القبر)، بينما يضل الله الظالمين. وتنتقل الآيات لتعرض مشهد الذين بدلوا نعمة الله كفراً (كفار قريش ومن تبعهم)، وكيف قادوا قومهم إلى "دار البوار" (الهلاك وهي جهنم).</p><p>وفي المقابل، يأمر الله عباده المؤمنين بإقامة الصلاة والإنفاق مما رزقهم سراً وعلانية، قبل أن يأتي يوم لا "بيع" فيه (فداء) ولا "خلال" (صداقة تنفع).</p><p>وتقرر الآيات قانون "الشكر": {لَئِن شَكَرْتُمْ لَأَزِيدَنَّكُمْ}، فالشكر قيد للنعم الموجودة وصيد للنعم المفقودة، وكفر النعم سبب للعذاب الشديد.</p>`,
                mcq: [{ q: "شبه الله \"الكلمة الطيبة\" في الآيات بـ:", opts: ["شجرة طيبة أصلها ثابت", "شجرة خبيثة اجتثت", "جبل راسخ"], ans: 0 }, { q: "المقصود بـ (دار البوار) التي أحل الكفار قومهم فيها:", opts: ["الدنيا", "جهنم", "القبر"], ans: 1 }, { q: "(لَئِن شَكَرْتُمْ لَأَزِيدَنَّكُمْ) تدل على أن الشكر سبب لـ:", opts: ["بقاء النعمة وزيادتها", "زوال النعمة", "ثبات النعمة دون زيادة"], ans: 0 }],
                tf: [{ q: "الكلمة الخبيثة (الكفر) لها أصل ثابت في الأرض كالجبال.", ans: false }, { q: "تثبيت الله للمؤمنين يكون في الدنيا فقط دون الآخرة.", ans: false }, { q: "كفر النعم وجحودها سبب لزوالها وحلول العذاب.", ans: true }]
            },
            {
                id: 16, type: 'text', title: "الدرس (16): تفسير سورة إبراهيم (42-52)",
                summary: `<p>تختتم سورة إبراهيم بوعيد شديد للظالمين، وتسلية للمظلومين. ينهى الله نبيه (والأمة تبع له) عن أن يحسب أن الله غافل عما يعمل الظالمون، فإمهالهم ليس غفلة، بل هو استدراج ليوم "تشخص فيه الأبصار" (تبقى مفتوحة لا تطرف من هول المشهد).</p><p>يصور القرآن حال الظالمين يوم القيامة: "مهطعين" (مسرعين بذل)، "مقنعي رءوسهم" (رافعي رءوسهم لا يلتفتون)، "لا يرتد إليهم طرفهم" (لا تغمض عيونهم)، و"أفئدتهم هواء" (فارغة من الخوف والفزع). حينها يطلبون العودة للدنيا ليجيبوا الدعوة، ولكن هيهات، فقد أقسموا من قبل ما لهم من "زوال" (انتقال للموت والبعث).</p><p>ثم تصف الآيات مقرهم في النار: "مقرنين في الأصفاد" (مقيدين بالسلاسل)، سرابيلهم (ثيابهم) من "قطران" (نحاس مذاب شديد الحرارة)، وتغشى وجوههم النار.</p><p>وتنتهي السورة بأن هذا القرآن "بلاغ" للناس؛ لينذروا به، وليعلموا أنما هو إله واحد، وليتذكر أولو الألباب. فالغاية من القرآن هي العلم والعمل والتذكير.</p>`,
                mcq: [{ q: "معنى كلمة (مُهْطِعِينَ) في وصف الناس يوم القيامة:", opts: ["مسرعين مع الذل", "مبطئين", "نائمين"], ans: 0 }, { q: "(مقرنين في الأصفاد) تعني أنهم:", opts: ["مكرمين في المجالس", "مقيدين بالسلاسل والقيود", "طلقاء الأيدي"], ans: 1 }, { q: "ثياب أهل النار (سرابيلهم) مصنوعة من:", opts: ["قطران (نحاس مذاب)", "حرير", "صوف"], ans: 0 }],
                tf: [{ q: "تأخير الله لعذاب الظالمين دليل على غفلته عنهم.", ans: false }, { q: "الكفار أقسموا في الدنيا أنهم لن يزولوا ولن يبعثوا.", ans: true }, { q: "الغاية من إنزال القرآن هي البلاغ والإنذار والتذكير.", ans: true }]
            },
            {
                id: 17, type: 'text', title: "الدرس (17): تفسير سورة الحجر (28-50)",
                summary: `<p>تروي الآيات قصة بدء الخلق وتكريم الإنسان. يذكر الله ملائكته بخلق بشر من "صلصال من حمأ مسنون" (طين يابس متغير اللون والرائحة)، وأمرهم بالسجود له سجود تكريم إذا نفخ فيه الروح. فسجد الملائكة كلهم أجمعون إلا "إبليس"، أبى واستكبر أن يسجد لبشر مخلوق من طين، معللاً ذلك بأنه خير منه (وهذا قياس فاسد).</p><p>فكان الجزاء الطرد من الرحمة (الرجم) واللعنة إلى يوم الدين. طلب إبليس "الإنظار" (التأخير) إلى يوم البعث، فأجابه الله لذلك (لحكمة الابتلاء). وهنا أعلن إبليس عداوته الصريحة: {لَأُزَيِّنَنَّ لَهُمْ فِي الْأَرْضِ وَلَأُغْوِيَنَّهُمْ أَجْمَعِينَ}، مستثنياً "عبادك منهم المخلصين" الذين لا سلطان له عليهم.</p><p>ثم تذكر الآيات مصير الغاوين: "جهنم"، لها سبعة أبواب، لكل باب منهم جزء مقسوم. وفي المقابل، المتقون في جنات وعيون، يدخلونها بسلام وأمن، وقد نزع الله ما في صدورهم من "غل" (حقد وحسد)، فأصبحوا إخواناً على سرر متقابلين، لا يمسهم "نصب" (تعب) ولا يخرجون منها أبداً.</p><p>وتختم بآية الرجاء والخوف: {نَبِّئْ عِبَادِي أَنِّي أَنَا الْغَفُورُ الرَّحِيمُ * وَأَنَّ عَذَابِي هُوَ الْعَذَابُ الْأَلِيمُ}.</p>`,
                mcq: [{ q: "المادة التي خُلق منها آدم عليه السلام كما في الآيات:", opts: ["نار سموم", "صلصال من حمأ مسنون", "نور"], ans: 1 }, { q: "استثنى إبليس من إغوائه صنفاً واحداً وهم:", opts: ["المخلصون", "الأغنياء", "الأقوياء"], ans: 0 }, { q: "عدد أبواب جهنم كما ورد في السورة:", opts: ["ثمانية", "سبعة", "ثلاثة"], ans: 1 }],
                tf: [{ q: "كان سجود الملائكة لآدم سجود عبادة.", ans: false }, { q: "نزع الله الغل والحقد من صدور أهل الجنة.", ans: true }, { q: "يمس أهل الجنة فيها التعب والنصب من كثرة النعيم.", ans: false }]
            },
            {
                id: 18, type: 'text', title: "الدرس (18): تفسير سورة الحجر (85-99)",
                summary: `<p>تؤكد الآيات أن خلق السماوات والأرض لم يكن عبثاً بل "بالحق"، وأن الساعة آتية لا ريب فيها. ويوجه الله نبيه ﷺ إلى "الصحف الجميل"، وهو الإعراض عن المسيئين دون عتاب أو أذى، والتوكل على "الخلاق العليم".</p><p>ثم يمتن الله على نبيه بأعظم النعم: {وَلَقَدْ آتَيْنَاكَ سَبْعًا مِّنَ الْمَثَانِي وَالْقُرْآنَ الْعَظِيمَ}. والسبع المثاني هي "سورة الفاتحة" (لأنها سبع آيات وتثنى في الصلاة). ومقابل هذه النعمة العظيمة، ينهاه الله عن "مد العين" (التطلع) إلى متاع الدنيا الزائل الذي متع به أصنافاً من الكفار، وألا يحزن عليهم، وأن "يخفض جناحه" (يتواضع ويلين) للمؤمنين.</p><p>ويأمره بالصدع بالحق: {فَاصْدَعْ بِمَا تُؤْمَرُ} (اجهر بالدعوة)، ويعلنه بأن الله "كفاه" المستهزئين الذين يجعلون مع الله إلهاً آخر. ويواسيه بأن الله يعلم ضيق صدره بما يقولون، وعلاج ذلك: {فَسَبِّحْ بِحَمْدِ رَبِّكَ وَكُن مِّنَ السَّاجِدِينَ}، والاستمرار في العبادة حتى يأتيه "اليقين"، وهو الموت.</p>`,
                mcq: [{ q: "المقصود بـ (سبعاً من المثاني):", opts: ["السبع الطوال", "سورة الفاتحة", "آيات السجود"], ans: 1 }, { q: "الأمر في قوله تعالى (فاصدع بما تؤمر):", opts: ["أسر بالدعوة", "اجهر بالدعوة", "هاجر"], ans: 1 }, { q: "معنى (اليقين) في قوله (واعبد ربك حتى يأتيك اليقين):", opts: ["العلم", "الموت", "النصر"], ans: 1 }],
                tf: [{ q: "الصفح الجميل هو العفو مع العتاب واللوم.", ans: false }, { q: "التسبيح والسجود من أعظم علاجات ضيق الصدر.", ans: true }, { q: "العبادة تسقط عن الإنسان إذا وصل لدرجة اليقين والمعرفة.", ans: false }]
            },
            {
                id: 19, type: 'text', title: "الدرس (19): تفسير سورة النحل (10-18)",
                summary: `<p>تسمى سورة النحل "سورة النعم". تستعرض هذه الآيات فيضاً من نعم الله الكونية. تبدأ بنعمة "الماء" النازل من السماء، منه شراب ومنه شجر ترعى فيه الأنعام، وبه ينبت الله الزروع المختلفة (الزيتون، النخيل، الأعناب). وتتفكر الآيات في تسخير "الليل والنهار والشمس والقمر والنجوم"، وكل ما ذرأ الله في الأرض من ألوان وأصناف، ليكون آية لقوم يذكرون.</p><p>ثم تنتقل لنعمة تسخير "البحر"، لنأكل منه لحماً طرياً (السمك)، ونستخرج منه حلية (اللؤلؤ والمرجان)، وترى الفلك (السفن) تمخر فيه لتبتغي من فضله (التجارة). وتذكر نعمة "الرواسي" (الجبال) التي تثبت الأرض لئلا تميد (تضطرب) بالناس، والأنهار والسبل (الطرق)، والعلامات والنجوم التي يهتدي بها الناس في ظلمات البر والبحر.</p><p>وتختم الآيات بتحدٍ للعقول: {أَفَمَن يَخْلُقُ كَمَن لَّا يَخْلُقُ}؟! وتقرر حقيقة عجز الإنسان عن إحصاء نعم الله: {وَإِن تَعُدُّوا نِعْمَةَ اللَّهِ لَا تُحْصُوهَا}، فالله غفور رحيم لتقصيركم في شكرها.</p>`,
                mcq: [{ q: "الفائدة من \"الرواسي\" (الجبال) كما ذكرت الآيات:", opts: ["للزينة", "لتثبيت الأرض أن تميد", "لتخزين الماء"], ans: 1 }, { q: "يستخرج الإنسان من البحر:", opts: ["اللحم الطري والحلية", "الحديد والنحاس", "الذهب والفضة"], ans: 0 }, { q: "قوله تعالى (وإن تعدوا نعمة الله ...):", opts: ["تحصوها بسهولة", "لا تحصوها", "تملوا منها"], ans: 1 }],
                tf: [{ q: "النجوم جعلها الله زينة ورجوماً وعلامات يهتدى بها.", ans: true }, { q: "يجوز المساواة بين الخالق (الله) والمخلوق (الأصنام) في العبادة.", ans: false }, { q: "الماء النازل من السماء سبب لحياة الأرض وإنبات الزرع.", ans: true }]
            },
            {
                id: 20, type: 'text', title: "الدرس (20): تفسير سورة النحل (112-117)",
                summary: `<p>يضرب الله مثلاً واقعياً لقرية (فسرها كثيرون بمكة) كانت آمنة مطمئنة، يأتيها رزقها رغداً (واسعاً) من كل مكان، فـ"كفرت بأنعم الله" (جحدتها ولم تشكرها)، فأذاقها الله لباس الجوع والخوف "بما كانوا يصنعون". وهذا تحذير من سنة الله في تغيير النعم عند زوال الشكر.</p><p>ثم تأمر الآيات بأكل الحلال الطيب وشكر النعمة، وتنهى عن التشريع بالهوى: {وَلَا تَقُولُوا لِمَا تَصِفُ أَلْسِنَتُكُمُ الْكَذِبَ هَذَا حَلَالٌ وَهَذَا حَرَامٌ}، فالمشركون حرموا ما أحل الله (كبعض الأنعام) وأحلوا ما حرم الله. إن الذين يفترون على الله الكذب لا يفلحون، متاعهم قليل وعذابهم أليم.</p><p>وحددت الآيات المحرمات من الأطعمة في أربعة أصول: "الميتة، والدم، ولحم الخنزير، وما أهل لغير الله به"، واستثنت حالة "الاضطرار" (غير باغ ولا عاد)، فالله غفور رحيم.</p>`,
                mcq: [{ q: "عاقبة القرية التي كفرت بأنعم الله كانت:", opts: ["زيادة في المال", "لباس الجوع والخوف", "الأمن والاستقرار"], ans: 1 }, { q: "التحليل والتحريم دون دليل شرعي يعتبر:", opts: ["افتراءً على الله", "اجتهاداً مأجوراً", "حرية شخصية"], ans: 0 }, { q: "من الأطعمة المحرمة المذكورة في الآيات:", opts: ["لحم الإبل", "لحم الخنزير", "السمك"], ans: 1 }],
                tf: [{ q: "الشكر يحفظ النعم الموجودة ويجلب النعم المفقودة.", ans: true }, { q: "أكل المضطر للمحرم (بقدر الحاجة ودون تعدٍ) جائز.", ans: true }, { q: "التحريم والتحليل حق للبشر حسب أهوائهم.", ans: false }]
            },
            {
                id: 21, type: 'text', title: "الدرس (21): تفسير سورة النحل (120-128)",
                summary: `<p>تختتم السورة بالثناء على إبراهيم عليه السلام، واصفة إياه بصفات عظيمة: كان "أمة" (إماماً جامعاً للخير)، "قانتاً" (مطيعاً خاشعاً)، "حنيفاً" (مائلاً عن الشرك)، ولم يك من المشركين، وكان "شاكراً لأنعمه". فاجتباه الله وهداه وآتاه في الدنيا حسنة وفي الآخرة من الصالحين.</p><p>ثم يوجه الله نبيه ﷺ إلى منهج الدعوة: {ادْعُ إِلَى سَبِيلِ رَبِّكَ بِالْحِكْمَةِ وَالْمَوْعِظَةِ الْحَسَنَةِ وَجَادِلْهُم بِالَّتِي هِيَ أَحْسَنُ}. وهذا دستور الدعوة الإسلامية؛ فالحكمة لمن يطلب الحق، والموعظة للغافل، والجدال الحسن للمعاند.</p><p>وتضع الآيات قاعدة العدل في العقوبة: {وَإِنْ عَاقَبْتُمْ فَعَاقِبُوا بِمِثْلِ مَا عُوقِبْتُم بِهِ}، ولكنها ترشد للأفضل وهو الصبر: {وَلَئِن صَبَرْتُمْ لَهُوَ خَيْرٌ لِّلصَّابِرِينَ}. وتأمر النبي بالصبر وعدم الحزن على مكرهم، مؤكدة "المعية الخاصة" لله: {إِنَّ اللَّهَ مَعَ الَّذِينَ اتَّقَوا وَالَّذِينَ هُم مُّحْسِنُونَ}.</p>`,
                mcq: [{ q: "معنى كلمة (أمة) في وصف إبراهيم عليه السلام:", opts: ["جماعة من الناس", "إماماً قدوة جامعاً للخير", "ديناً ومذهباً"], ans: 1 }, { q: "الأسلوب الأمثل في دعوة المعاندين هو:", opts: ["الجدال بالتي هي أحسن", "العنف والقوة", "الترك والإهمال"], ans: 0 }, { q: "\"معية الله\" في قوله (إن الله مع الذين اتقوا) هي معية:", opts: ["عامة (بالعلم)", "خاصة (بالنصر والتأييد)", "مكانية"], ans: 1 }],
                tf: [{ q: "يجوز للمظلوم أن يعاقب الظالم بأكثر مما فعل به.", ans: false }, { q: "الصبر على الأذى أفضل من الانتقام والقصاص.", ans: true }, { q: "كان إبراهيم عليه السلام يهودياً أو نصرانياً.", ans: false }]
            },
            {
                id: 22, type: 'text', title: "الدرس (22): تفسير سورة الإسراء (23-30)",
                summary: `<p>تتضمن هذه الآيات "الوصايا العشر" في سورة الإسراء، وهي قواعد لبناء المجتمع. تبدأ بأعظم حقين: عبادة الله وحده (التوحيد)، وبالوالدين إحساناً. وتفصل في بر الوالدين خاصة عند الكبر: فلا تقل لهما "أف" (أدنى درجات التضجر)، ولا تنهرهما، وقل لهما قولاً كريماً، واخفض لهما جناح الذل من الرحمة، وادع لهما.</p><p>ثم تنتقل للحقوق الاجتماعية: آتِ ذي القربى حقه والمسكين وابن السبيل. وتنهى عن "التبذير" (إنفاق المال في المعاصي أو بغير حق)، واصفة المبذرين بأنهم "إخوان الشياطين". وتوجه إلى التوسط في الإنفاق: {وَلَا تَجْعَلْ يَدَكَ مَغْلُولَةً إِلَى عُنُقِكَ} (بخل)، {وَلَا تَبْسُطْهَا كُلَّ الْبَسْطِ} (إسراف)، فتقعد ملوماً محسوراً.</p><p>وتختم بأن الرزق بيد الله، يبسطه لمن يشاء ويقدره، فهو خبير بصير بعباده، يعطي ويمنع لحكمة.</p>`,
                mcq: [{ q: "أدنى كلمة نهى الله عن قولها للوالدين هي:", opts: ["لا", "أف", "لِمَ"], ans: 1 }, { q: "وصف الله المبذرين بأنهم:", opts: ["إخوان الشياطين", "سفهاء", "ضعفاء العقول"], ans: 0 }, { q: "الأمر في قوله (ولا تجعل يدك مغلولة إلى عنقك) كناية عن النهي عن:", opts: ["البخل", "السرقة", "الضرب"], ans: 0 }],
                tf: [{ q: "قرن الله بر الوالدين بتوحيده لعظم حقهما.", ans: true }, { q: "التبذير والإسراف بمعنى واحد وهو الإنفاق في الحلال.", ans: false }, { q: "البسط في الرزق والتضييق خاضع لحكمة الله وعلمه بعباده.", ans: true }]
            },
            {
                id: 23, type: 'text', title: "الدرس (23): تفسير سورة الإسراء (31-39)",
                summary: `<p>تستكمل الآيات الوصايا الاجتماعية والأخلاقية. تنهى عن "قتل الأولاد" خشية الفقر (إملاق)، فالله يرزقهم وإياكم، وقتلهم خطأ كبير. وتنهى عن "قربان الزنا" (مقدماته)، فهو فاحشة وساء سبيلاً. وتحرم "قتل النفس" إلا بالحق، وتجعل لولي المقتول "سلطاناً" (حق القصاص أو الدية)، وتنهاه عن الإسراف في القتل (قتل غير القاتل أو التمثيل به).</p><p>وتأمر بحفظ "مال اليتيم" حتى يبلغ أشده، و"الوفاء بالعهد" لأن العهد مسؤولية، و"إيفاء الكيل والميزان" بالقسطاس المستقيم. وتنهى عن اتباع "الظن" وما ليس للإنسان به علم، مؤكدة مسؤولية الحواس (السمع والبصر والفؤاد) أمام الله.</p><p>وتختم بالنهي عن "الخلاء والكبر": {وَلَا تَمْشِ فِي الْأَرْضِ مَرَحًا}، فالإنسان ضعيف لن يخرق الأرض ولن يبلغ الجبال طولاً. كل هذه السيئات مكروهة عند الله.</p>`,
                mcq: [{ q: "النهي عن قتل الأولاد في الجاهلية كان بسبب الخوف من:", opts: ["العار", "الإملاق (الفقر)", "المرض"], ans: 1 }, { q: "(ولا تقف ما ليس لك به علم) نهي عن:", opts: ["القول بلا علم والظن", "التعلم", "السؤال"], ans: 0 }, { q: "جعل الله لولي المقتول ظلماً \"سلطاناً\"، والمقصود به:", opts: ["الحكم والملك", "حق القصاص أو الدية", "أخذ مال القاتل"], ans: 1 }],
                tf: [{ q: "نهى الله عن الاقتراب من الزنا وليس فقط عن فعله سداً للذريعة.", ans: true }, { q: "يجوز لولي المقتول أن يقتل غير القاتل من قبيلته انتقاماً.", ans: false }, { q: "السمع والبصر والفؤاد جوارح مسؤولة يسأل عنها العبد يوم القيامة.", ans: true }]
            },
            {
                id: 24, type: 'text', title: "الدرس (24): تفسير سورة الإسراء (78-87)",
                summary: `<p>تنتقل الآيات لتنظيم علاقة النبي والمؤمنين بربهم عبر "الصلاة". تأمر بإقامة الصلاة من "دلوك الشمس" (زوالها ظهراً) إلى "غسق الليل" (ظلمته)، وتشخص "قرآن الفجر" (صلاة الفجر) بأنها مشهودة (تحضرها ملائكة الليل والنهار). وتخص النبي ﷺ بنافلة "التهجد" بالليل عسى أن يبعثه الله "مقاماً محموداً" (الشفاعة العظمى).</p><p>وتعلم النبي الدعاء بصدق المدخل والمخرج والسلطان النصير، وإعلان "جاء الحق وزهق الباطل". وتصف القرآن بأنه "شفاء ورحمة للمؤمنين"، بينما لا يزيد الظالمين إلا خساراً.</p><p>وتجيب عن سؤال اليهود عن "الروح"، بأنها "من أمر ربي" وما أوتيتم من العلم إلا قليلاً. وتذكر بمنة الله في إنزال القرآن وحفظه، فلولا رحمة الله لذهب به.</p>`,
                mcq: [{ q: "\"قرآن الفجر\" المذكور في الآيات هو:", opts: ["قراءة القرآن صباحاً", "صلاة الفجر", "أذكار الصباح"], ans: 1 }, { q: "\"المقام المحمود\" الذي وعد الله به نبيه هو:", opts: ["الشفاعة العظمى يوم القيامة", "ملك الدنيا", "كثرة الأتباع"], ans: 0 }, { q: "الروح علمها عند:", opts: ["الأنبياء", "الله وحده", "العلماء"], ans: 1 }],
                tf: [{ q: "صلاة الفجر تشهدها ملائكة الليل وملائكة النهار.", ans: true }, { q: "القرآن شفاء للأبدان والقلوب للمؤمنين فقط.", ans: true }, { q: "أوتي البشر كل العلم عن الروح وأسرارها.", ans: false }]
            },
            {
                id: 25, type: 'text', title: "الدرس (25): تفسير سورة الإسراء (105-111)",
                summary: `<p>تختتم سورة الإسراء بالحديث عن عظمة القرآن: {وَبِالْحَقِّ أَنزَلْنَاهُ وَبِالْحَقِّ نَزَلَ}. نزل "مفرقاً" (على مكث) ليقرأه النبي على الناس بتمهل وتدبر. وتصف حال أهل العلم والإيمان (أوتوا العلم من قبله) إذا تلي عليهم القرآن: "يخرون للأذقان سجداً" (يسجدون على وجوههم)، ويبكون ويزيدهم خشوعاً، ويقولون: {سُبْحَانَ رَبِّنَا إِن كَانَ وَعْدُ رَبِّنَا لَمَفْعُولًا}.</p><p>وترد على المشركين في أسمائه الحسنى: {ادْعُوا اللَّهَ أَوِ ادْعُوا الرَّحْمَنَ}، فأيما تدعوا فله الأسماء الحسنى. وتأمر بالتوسط في القراءة في الصلاة: {وَلَا تَجْهَرْ بِصَلَاتِكَ وَلَا تُخَافِتْ بِهَا}.</p><p>وآخر آية هي "آية العز": {وَقُلِ الْحَمْدُ لِلَّهِ الَّذِي لَمْ يَتَّخِذْ وَلَدًا...}، تنزيه لله عن الولد، وعن الشريك في الملك، وعن الولي من الذل (لا يحتاج لناصر)، وتختم بالأمر بتكبيره تكبيراً.</p>`,
                mcq: [{ q: "نزل القرآن مفرقاً (منجماً) والحكمة من ذلك:", opts: ["ليقرأ على الناس بتؤدة وتثبيت", "لأنه طويل", "لنسخ الكتب السابقة"], ans: 0 }, { q: "حال أهل العلم عند سماع القرآن كما وصفتهم الآيات:", opts: ["يجادلون", "يخرون للأذقان يبكون", "يستمعون بصمت فقط"], ans: 1 }, { q: "الأمر في قوله (ولا تجهر بصلاتك ولا تخافت بها):", opts: ["السرية التامة", "التوسط بين الجهر والسر", "الجهر الشديد"], ans: 1 }],
                tf: [{ q: "يجوز دعاء الله بأي اسم من أسمائه الحسنى الثابتة.", ans: true }, { q: "الله يحتاج إلى ولي ينصره من الذل والضعف.", ans: false }, { q: "سجود التلاوة مستحب عند قراءة آيات السجود تأثراً بالقرآن.", ans: true }]
            }
        ];

        // --- الطالب الافتراضي ---
        const defaultStudent = { username: "3", password: "3", name: "سعيد", section: "3", progress: {} };
        const DB_KEY = 'IslamicApp_Final_Complete_V2';
        let db = { users: [], lessons: JSON.parse(JSON.stringify(initialLessons)), adminPin: "1234" };
        let currentUser = null; 

        function initApp() {
            const savedData = localStorage.getItem(DB_KEY);
            if (savedData) {
                try {
                    const parsed = JSON.parse(savedData);
                    db = parsed;
                    // تحقق صارم: إذا كانت الدروس أقل من 25، استعد الافتراضي فوراً
                    if (!db.lessons || !Array.isArray(db.lessons) || db.lessons.length < 25) {
                        console.log("Restoring full lessons...");
                        db.lessons = JSON.parse(JSON.stringify(initialLessons));
                    }
                } catch(e) { db.lessons = JSON.parse(JSON.stringify(initialLessons)); }
            }
            if (!db.users) db.users = [];
            const saeedExists = db.users.find(u => u.username === defaultStudent.username);
            if (!saeedExists) { db.users.push(defaultStudent); saveDB(); }
        }

        function saveDB() { localStorage.setItem(DB_KEY, JSON.stringify(db)); }

        // --- إصلاح دالة تسجيل دخول المعلم ---
        function showAdminLogin() { showSection('admin-login-view'); }

        function toggleAuth(type) {
            document.getElementById('login-box').style.display = type === 'login' ? 'block' : 'none';
            document.getElementById('register-box').style.display = type === 'register' ? 'block' : 'none';
            document.querySelectorAll('input').forEach(i => i.value = '');
        }

        document.getElementById('register-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('reg-username').value.trim();
            if (db.users.find(u => u.username === username)) { alert("اسم المستخدم موجود"); return; }
            const newUser = {
                username: username, password: document.getElementById('reg-password').value,
                name: document.getElementById('reg-fullname').value, section: document.getElementById('reg-section').value,
                progress: {} 
            };
            db.users.push(newUser); saveDB(); alert("تم إنشاء الحساب"); toggleAuth('login');
        });

        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const u = document.getElementById('login-username').value.trim();
            const p = document.getElementById('login-password').value;
            const user = db.users.find(usr => usr.username === u && usr.password === p);
            if (user) { currentUser = user; if(!currentUser.progress) currentUser.progress = {}; showDashboard(); }
            else { alert("بيانات الدخول غير صحيحة"); }
        });

        function logout() { currentUser = null; showSection('auth-view'); }

        function showSection(sectionId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            window.scrollTo(0,0);
            const fab = document.getElementById('floating-home-btn');
            if(sectionId !== 'auth-view' && sectionId !== 'dashboard-view') fab.style.display = 'flex'; else fab.style.display = 'none';
        }

        function showDashboard() {
            if(!currentUser) return showSection('auth-view');
            document.getElementById('user-display').textContent = `مرحباً، ${currentUser.name}`;
            document.getElementById('user-display').style.display = 'block';
            renderLessonsList();
            showSection('dashboard-view');
        }

        function renderLessonsList() {
            const container = document.getElementById('lessons-list');
            container.innerHTML = '';
            db.lessons.forEach(lesson => {
                const isDone = currentUser.progress[lesson.id];
                const card = document.createElement('div');
                card.className = 'lesson-card';
                card.onclick = () => openTextLesson(lesson.id);
                let status = isDone ? `<span class="badge-completed">الدرجة: ${isDone.score}%</span>` : '<span class="badge-pending">لم يبدأ</span>';
                card.innerHTML = `<h3>${lesson.title}</h3><div class="lesson-status">${status}<i class="fas ${isDone ? 'fa-check-circle' : 'fa-arrow-left'}"></i></div>`;
                container.appendChild(card);
            });
        }

        let activeLessonId = null;
        function openTextLesson(id) {
            activeLessonId = id;
            const lesson = db.lessons.find(l => l.id === id);
            document.getElementById('lesson-content-area').innerHTML = `<h2>${lesson.title}</h2><div>${lesson.summary}</div>`;
            const isDone = !!currentUser.progress[id];
            const btn = document.getElementById('quiz-action-btn');
            btn.innerHTML = isDone ? '<i class="fas fa-eye"></i> عرض النتيجة والمراجعة' : '<i class="fas fa-pen-fancy"></i> انتقل إلى الاختبار';
            if(isDone) btn.classList.add('btn-secondary'); else btn.classList.remove('btn-secondary');
            showSection('lesson-view');
        }

        function startOrReviewQuiz() {
            const lesson = db.lessons.find(l => l.id === activeLessonId);
            const userProgress = currentUser.progress[activeLessonId];
            const isReview = !!userProgress;
            
            document.getElementById('quiz-title').textContent = lesson.title;
            const resArea = document.getElementById('result-display-area');
            const submitBtn = document.getElementById('submit-quiz-btn');

            if(isReview) {
                let msg = getMotivationalMessage(userProgress.score);
                resArea.innerHTML = `<div class="result-banner"><h3>${msg.title}</h3><p>الدرجة السابقة: %${userProgress.score}</p><div class="motivational-text">${msg.body}</div></div>`;
                submitBtn.style.display = 'none';
            } else {
                resArea.innerHTML = '';
                submitBtn.style.display = 'inline-block';
            }
            renderQuestions(lesson, isReview, userProgress);
            showSection('quiz-view');
        }

        function getMotivationalMessage(score) {
            if(score === 100) return { title: "ممتاز يا بطل!", body: "أداء مذهل!" };
            if(score >= 90) return { title: "أحسنت!", body: "قريب جداً من الكمال." };
            if(score >= 75) return { title: "جيد جداً!", body: "جهد رائع." };
            return { title: "مبارك الاجتياز", body: "راجع أكثر لتتفوق." };
        }

        function renderQuestions(lesson, isReview, prog) {
            const container = document.getElementById('quiz-questions-area');
            container.innerHTML = '';
            if(isReview) container.classList.add('review-mode'); else container.classList.remove('review-mode');

            const createQ = (q, idx, type) => {
                let userAns = isReview ? prog.answers[`${type}-${idx}`] : null;
                if(type === 'tf' && typeof userAns === 'string') userAns = (userAns === 'true');
                
                let cls = '';
                if(isReview) cls = ((type=='mcq' && userAns==q.ans)||(type=='tf' && userAns===q.ans)) ? 'correct' : 'incorrect';
                
                let opts = '';
                if(type === 'mcq') {
                    q.opts.forEach((o, i) => {
                        let c = ''; let ch = '';
                        if(isReview) { if(i==q.ans) c='opt-correct'; if(i==userAns) ch='checked'; if(i==userAns && i!=q.ans) c='opt-wrong-selected'; }
                        opts += `<label class="${c}"><input type="radio" name="${type}-${idx}" value="${i}" ${ch} required> ${o}</label>`;
                    });
                } else {
                    let tc='', fc='';
                    if(isReview) { 
                        if(q.ans===true) tc='opt-correct'; else fc='opt-correct';
                        if(userAns===true && q.ans!==true) tc='opt-wrong-selected';
                        if(userAns===false && q.ans!==false) fc='opt-wrong-selected';
                    }
                    opts = `<div style="display:flex; gap:10px;"><label class="${tc}" style="flex:1"><input type="radio" name="${type}-${idx}" value="true" ${isReview && userAns===true?'checked':''} required> صح</label><label class="${fc}" style="flex:1"><input type="radio" name="${type}-${idx}" value="false" ${isReview && userAns===false?'checked':''} required> خطأ</label></div>`;
                }
                return `<div class="question-block ${cls}"><div class="question-text">${idx+1}. ${q.q}</div><div class="options-group">${opts}</div></div>`;
            };

            if(lesson.mcq) lesson.mcq.forEach((q, i) => container.innerHTML += createQ(q, i, 'mcq'));
            if(lesson.tf) lesson.tf.forEach((q, i) => container.innerHTML += createQ(q, i, 'tf'));
        }

        document.getElementById('quiz-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const lesson = db.lessons.find(l => l.id === activeLessonId);
            let score = 0, total = (lesson.mcq?.length||0) + (lesson.tf?.length||0), answers = {};
            if(lesson.mcq) lesson.mcq.forEach((q, i) => { const el = document.querySelector(`input[name="mcq-${i}"]:checked`); if(el) { answers[`mcq-${i}`] = parseInt(el.value); if(parseInt(el.value)===q.ans) score++; } });
            if(lesson.tf) lesson.tf.forEach((q, i) => { const el = document.querySelector(`input[name="tf-${i}"]:checked`); if(el) { answers[`tf-${i}`] = el.value; if((el.value==='true')===q.ans) score++; } });
            
            const pct = Math.round((score/total)*100);
            const uIdx = db.users.findIndex(u => u.username === currentUser.username);
            db.users[uIdx].progress[activeLessonId] = { score: pct, answers: answers };
            currentUser = db.users[uIdx]; saveDB();
            startOrReviewQuiz(); window.scrollTo(0,0);
        });

        // --- Admin Functions ---
        function verifyAdmin() {
            if(document.getElementById('admin-pin').value === db.adminPin) {
                const tbody = document.getElementById('students-table-body'); tbody.innerHTML = '';
                db.users.forEach(u => {
                    const prog = u.progress ? Object.keys(u.progress).length : 0;
                    const pct = Math.round((prog/db.lessons.length)*100);
                    let det = '';
                    db.lessons.forEach(l => { if(u.progress && u.progress[l.id]) det += `[${l.id}:${u.progress[l.id].score}%] `; });
                    tbody.innerHTML += `<tr><td>${u.name}</td><td>${u.section}</td><td>${pct}%</td><td>${det}</td></tr>`;
                });
                document.getElementById('lessons-json-editor').value = JSON.stringify(db.lessons, null, 2);
                document.getElementById('export-area').value = JSON.stringify(db);
                showSection('admin-dashboard-view');
            } else alert("رمز خاطئ");
        }
        function logoutAdmin() { showSection('auth-view'); }
        function saveContentChanges() { try { db.lessons = JSON.parse(document.getElementById('lessons-json-editor').value); saveDB(); alert("تم"); } catch(e){alert("خطأ");} }
        function resetLessonsToDefault() { if(confirm("تأكيد؟")) { db.lessons = JSON.parse(JSON.stringify(initialLessons)); saveDB(); location.reload(); } }
        function copyExportData() { document.getElementById("export-area").select(); document.execCommand("copy"); alert("تم النسخ"); }
        function importData() { try { db = JSON.parse(document.getElementById('import-area').value); saveDB(); location.reload(); } catch(e){alert("خطأ");} }
        function switchAdminTab(t) { document.querySelectorAll('.admin-tab-content').forEach(e=>e.classList.remove('active')); document.getElementById(`tab-${t}`).classList.add('active'); }
        function exportGradesCSV() {
            let csv = "\uFEFFالاسم,الشعبة,التقدم\n";
            db.users.forEach(u => {
                const p = u.progress ? Math.round((Object.keys(u.progress).length/db.lessons.length)*100) : 0;
                csv += `"${u.name}","${u.section}","${p}%"\n`;
            });
            const l = document.createElement("a"); l.href = "data:text/csv;charset=utf-8," + encodeURI(csv); l.download = "grades.csv"; l.click();
        }

        window.onload = function() { initApp(); showSection('auth-view'); };
    </script>
</body>
</html>